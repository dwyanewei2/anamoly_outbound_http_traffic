\section{Related Work}

Many studies~\cite{feily2009survey}~\cite{barford2007inside}~\cite{strayer2008botnet}~\cite{atluri2017botnets} focus on the C\&C connection detection for identifying Botnet, such as: IRC, HTTP, SMTP in the phases of probe, penetrate, escalate, expand of cyber killer chain. And Livadas et al.~\cite{carl2006using}~\cite{strayer2006detecting} represent a machine learning based approach to detect botnet by using the network traffic. The approach is focused on chat-like protocols such as IRC.Malware clustering is capable to generate the malware signatures of communication on the network. Several studies generate the signatures via clustering approaches from known botnet traffics~\cite{p:zarras14}~\cite{nelms2013execscent}. Perdisci et al.~\cite{perdisci2013scalable}~\cite{perdisci2010behavioral} proposed a technique that using URL similarities, and extracts subtokens from URLs to clusters malware sample. And using the cluster to identify malicious traffic on the network. Rafique and Caballero~\cite{rafique2013firma} proposed a tool which calls FIRMA that generates a set of signatures for each malware family by aggregates malware samples into families based on similar protocol features.  

Anomaly-based detections leverage different kinds features to identify different kinds of malware traffics, such as detail of service~\cite{p:feinstein03}, context of Web attacks~\cite{p:krugel03}, encrypted data exfiltration~\cite{p:he14}.  Although most of this work uses pre-defined features from experts,  “DNS Tunneling Detector by DL” uses neither specified features, nor  known malicious samples to train the models~\cite{j:zhang16}. Other works need a large amount of the sample to train the models~\cite{bilge2012disclosure}~\cite{gu2008botminer}~\cite{binkley2006algorithm}~\cite{karasaridis2007wide}.  In addition, several work incorporates network and host features to do the detection~\cite{p:schwenk11}~\cite{borders2004web}.  In order to solve the problem of missing malicious sample, some studies~\cite{wang2018botcapturer} have mixed the real world data with simulated data. Furthermore, Eslahi et al.~\cite{eslahi2013efficient} proposed an approach to reduce the false positive rate in HTTP-based botnet detection. However, most kind of these works still suffers high false positive problems result in being impractical.

Many studies use the HTTP headers to detect suspicious traffic is mainly focused on the User-Agent. As Kheir et al. work~\cite{kheir2013behavioral}, they use the general signatures which call of User-Agents to filter out the same signature cluster as labeled as legitimate and the left is labeled as malicious. The biggest problem with this approach is that it can only detect specific malware with use constant User-Agent field to connect or send through HTTP protocol. And the report~\cite{bartos2016optimized} shows that it is not only used in web browsing but also for other types of uses like the malware attacks.

In 2017, Bortolameotti et al.~\cite{bortolameotti2017decanter} proposed DECANTeR system to identify the outbound HTTP traffics whether anomalous or not.   The proposed method note only intends to create detection model without from sets of known malware samples, but also without additional knowledge of threats or known malware samples. Therefore, we try to fix this problem in this paper. 