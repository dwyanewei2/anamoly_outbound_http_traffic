\section{Experiment Results}

In this section, we would describe the datasets that we used to perform our experiments. For starting our experiments we have used two different datasets, simulated and real-world data. The simulated data is enable to evaluate the detection performance of our system and compare with DECANTeR \cite{bortolameotti2017decanter}.


\subsection{Experimental Settings}

\begin{table*}[!h]
\centering
\caption{Overview of the Datasets}
\label{tbl:db_02}
\begin{tabular}{|c|c|c|c|c|}
\hline
Dataset         & Features & Type            & All Samples & Malicious Samples \\ \hline
Industy\_flow01 & Packets  & Malicious Flows & 1690869     & N/A               \\ \hline
Industy\_flow02 & Packets  & Malicious Flows & 68234       & N/A               \\ \hline
Dataset\_01     & Packets  & Botnet          & 220         & 220               \\ \hline
Dataset\_02     & Packets  & Botnet          & 216         & 216               \\ \hline
Dataset\_03     & Packets  & Botnet          & 1045         & 168               \\ \hline
\end{tabular}
\end{table*}


In the following, we briefly present the datasets we used for evaluation in our system.

\begin{itemize}

\item {\bf Real-world Data}

The outbound HTTP traffics we collect from more than hundreds of machines in a technology industry. Users of these machines include accountants, engineers, sales executive, and administrative personnel. Since the users vary from different occupations that lets data become various and complexity. The real world dataset has split into two sets, one is training and the other is testing. Training set has covered first few days and testing set is the traffics of last days. In training set, it contains 1,690,869 HTTP requests. and the testing set contains 68,234 HTTP requests in this real-world dataset.

\item {\bf Simulated Data}

In this paper, our goal is a detection of counterfeit fingerprint which would pretend to be browser activities in outbound HTTP traffics. However, this kind of attack is secret and hidden penetration, and hard to collect in the real world. Therefore, we build a botnet malware and monitor its outbound HTTP traffics. As we know, early botnets generally used Internet Relay Chat (IRC) channel to communicate C\&C server. In recent years, botnets also start to communicate C\&C server through HTTP protocol. Furthermore, we need to build a botnet with the spoofing headers which can evade other detection systems. That is why we collect three different simulated botnet traffics. In dataset\_01, it has no spoofing headers from infected host's outbound HTTP traffics. Dataset\_02 consists of the botnet traffics with simple spoofing, and which means our botnet sending the requests to web-like user agent through HTTP protocol. Finally, dataset\_03 is totally modifying the headers information, and the malware investigates which browser is used by the user or host, and fills the field User-Agent with that specific browser. Moreover, it also fills up some common requests header fields, like Accept, Accept-Encoding, Accept-Language, and Referrer.

\end{itemize}

The detail information or the dataset is represented in table~\ref{tbl:db_02}.

\subsection{Evaluation Metrics}

Essentially, Our system is a flow filter aim to identify the suspicious requests with the headers field. Four well-known metrics for evaluating the effectiveness of proposed method are adopted as followings: ``true positive''($TP$) means the number of normal requests which belong to normal traffic. ``False negative''($FN$) is the number of normal traffic and its results are wrongly predicted. Similarly, ``true negative''($TN$) means the number of abnormal traffic and the system predict it as malicious requests, while ``false positive''($FP$) is the number of abnormal traffic that the system predicts it as normal traffic. Based on the accumulation of $TP, FN, TN$, and $FP$, one extended metrics ($accuracy$) popularly used in machine learning problems are also adopted here to evaluate proposed method and listed in equations below. Note that the optimal $accuracy$ of $1.0$ means all of the malware are successfully picked out by the proposed approach. 


\begin{eqnarray}
\label{eq:accuracy}
Accuracy = \frac{TP+TN}{TP+TN+FP+FN}
\end{eqnarray}

\subsection{Effectiveness Analysis}

Just as we know, malware can easily modify the HTTP headers. Hence, we build three similar malware to evaluate our approach. With these botnets, they all have the same purpose. Moreover, they would steal some sensitive information (such as OS information, system account, and the password) and send requests to the C\&C server periodically waiting for commands to execute. The difference between them is the degree of the spoofing HTTP headers. The botnet in dataset\_01 does not spoof any HTTP headers. We fill up with the empty to the User-Agent field. The botnet in datset\_02 only simply sets the User-agent as a common browser which calls Internet Explore (IE). In the dataset\_03 , botnet would specifically detect the victim's browser version, system language and then fill them into the HTTP header fields. In addition, for the reference field in HTTP headers we default to point to the google website. The result show in table~\ref{tbl:db_03}, we can see both detection system has the great performance with dataset\_01 and dataset\_02. However, we can notice that our system has a better performance for botnets that based on advanced spoofing methods.

\begin{table*}[!h]
\centering
\caption{Simulated Data}
\label{tbl:db_03}
\begin{tabular}{|c|c|c|c|c|c|c|c|}
\hline
\multirow{2}{*}{Dataset}     & \multirow{2}{*}{System} & \multirow{2}{*}{HTTP Requests} & \multicolumn{4}{c|}{Evaluation Metrics} & \multirow{2}{*}{Accuracy} \\ \cline{4-7}
                             &                         &                                & TP       & TN       & FP       & FN     &                           \\ \hline
\multirow{2}{*}{Dataset\_01} & DECANTeR \cite{bortolameotti2017decanter}                & \multirow{2}{*}{220}           &          &          &          &        &                           \\ \cline{2-2} \cline{4-8} 
                             & Our System              &                                &          &          &          &        &                           \\ \hline
\multirow{2}{*}{Dataset\_02} & DECANTeR \cite{bortolameotti2017decanter}                & \multirow{2}{*}{216}           &          &          &          &        &                           \\ \cline{2-2} \cline{4-8} 
                             & Our System              &                                &          &          &          &        &                           \\ \hline
\multirow{2}{*}{Dataset\_03} & DECANTeR \cite{bortolameotti2017decanter}                & \multirow{2}{*}{1045}          & 869      & 0        & 168      & 8      & 0.8315                    \\ \cline{2-2} \cline{4-8} 
                             & Our System              &                                & 869      & 168      & 0        & 8      & 0.9923                    \\ \hline
\end{tabular}
\end{table*}


\subsection{Limitation and Future Work}
